{
  "config": {
    "recursionLimit": 100,
    "eventEmitter": {
      "defaultMaxListeners": 20
    },
    "a2aEndpoint": {
      "port": 3002,
      "agentCard": {
        "name": "ResearchExecutionAgent",
        "description": "èª¿æŸ»å®Ÿè¡Œã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ - ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã«åŸºã¥ã„ã¦Webæ¤œç´¢ã‚’å®Ÿè¡Œã—ã€èª¿æŸ»çµæœã‚’åé›†ã—ã¾ã™",
        "supportedMessageFormats": [
          "text/plain",
          "application/json"
        ],
        "acceptedInputs": [
          {
            "name": "task_description",
            "description": "å®Ÿè¡Œã™ã‚‹å€‹åˆ¥ã‚¿ã‚¹ã‚¯ã®èª¬æ˜ï¼ˆobjective ã¨ success_criteria ã‚’å«ã‚€ï¼‰"
          }
        ],
        "producedOutputs": [
          {
            "name": "research_results",
            "description": "ã‚¿ã‚¹ã‚¯ã®èª¿æŸ»çµæœã¨ã‚½ãƒ¼ã‚¹æƒ…å ±"
          }
        ]
      }
    }
  },
  "mcpServers": {
    "web-search": {
      "transport": "stdio",
      "command": "node",
      "args": [
        "/Users/akirakudo/Desktop/MyWork/MPC/web-search/build/index.js"
      ]
    }
  },
  "mcpConfig": {
    "throwOnLoadError": false,
    "prefixToolNameWithServerName": true,
    "additionalToolNamePrefix": "mcp"
  },
  "models": [
    {
      "id": "researchModel",
      "type": "OpenAI",
      "config": {
        "model": "gpt-4o-mini",
        "temperature": 0.3
      },
      "bindMcpServers": true,
      "systemPrompt": "ã‚ãªãŸã¯å¸‚å ´èª¿æŸ»ã‚’å°‚é–€ã¨ã™ã‚‹ãƒªã‚µãƒ¼ãƒã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã™ã€‚\n\nè²¬ä»»:\n1. ã‚¿ã‚¹ã‚¯èª¬æ˜ã«åŸºã¥ã„ã¦åŒ…æ‹¬çš„ãªèª¿æŸ»ã‚’å®Ÿè¡Œã™ã‚‹\n2. Webæ¤œç´¢ãƒ„ãƒ¼ãƒ«ï¼ˆmcp_web-search_searchï¼‰ã‚’ä½¿ç”¨ã—ã¦é–¢é€£æƒ…å ±ã‚’åé›†ã™ã‚‹\n3. åé›†ã—ãŸæƒ…å ±ã‚’æ§‹é€ åŒ–ã—ã¦æ•´ç†ã™ã‚‹\n4. ä¿¡é ¼ã§ãã‚‹æƒ…å ±æºã‚’ç‰¹å®šã—ã€å¼•ç”¨ã™ã‚‹\n5. èª¿æŸ»çµæœã‚’è©³ç´°ã«ã¾ã¨ã‚ã‚‹\n\nèª¿æŸ»ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³:\n- ã‚¿ã‚¹ã‚¯ã®ç›®çš„ã¨æˆåŠŸåŸºæº–ã‚’ç†è§£ã™ã‚‹\n- è¤‡æ•°ã®æƒ…å ±æºã‹ã‚‰æƒ…å ±ã‚’åé›†ã™ã‚‹ï¼ˆæœ€ä½3ã¤ã®æ¤œç´¢ã‚’å®Ÿè¡Œï¼‰\n- äº‹å®Ÿã¨æ„è¦‹ã‚’åŒºåˆ¥ã™ã‚‹\n- æƒ…å ±ã®é®®åº¦ã¨ä¿¡é ¼æ€§ã‚’è©•ä¾¡ã™ã‚‹\n- æ¤œç´¢ã‚¯ã‚¨ãƒªã‚’æœ€é©åŒ–ã—ã¦é–¢é€£æ€§ã®é«˜ã„çµæœã‚’å¾—ã‚‹\n- å…¬å¼ã‚µã‚¤ãƒˆã€æ¥­ç•Œãƒ¬ãƒãƒ¼ãƒˆã€ãƒ‹ãƒ¥ãƒ¼ã‚¹è¨˜äº‹ã‚’å„ªå…ˆçš„ã«å‚ç…§ã™ã‚‹\n\nWebæ¤œç´¢ãƒ„ãƒ¼ãƒ«:\n- mcp_web-search_search: ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰æ¤œç´¢ã‚’å®Ÿè¡Œ\n  - æ—¥æœ¬èªãƒ»è‹±èªã®ä¸¡æ–¹ã«å¯¾å¿œ\n  - è¤‡æ•°ã®æ¤œç´¢ã‚’çµ„ã¿åˆã‚ã›ã¦åŒ…æ‹¬çš„ãªæƒ…å ±ã‚’åé›†\n  - æ¤œç´¢çµæœã®URLã‚’å¿…ãšè¨˜éŒ²\n\næ—¥æœ¬èªã§ã®èª¿æŸ»ä¾é ¼ã«å¯¾å¿œã—ã€300æ–‡å­—ä»¥ä¸Šã®è©³ç´°ãªèª¿æŸ»çµæœã‚’è¿”ã—ã¦ãã ã•ã„ã€‚"
    }
  ],
  "stateAnnotation": {
    "name": "AgentState",
    "type": "Annotation.Root"
  },
  "annotation": {
    "messages": {
      "type": "BaseMessage[]",
      "reducer": "(x, y) => x.concat(y)",
      "default": []
    }
  },
  "nodes": [
    {
      "id": "research_executor",
      "handler": {
        "parameters": [
          {
            "name": "state",
            "type": "typeof AgentState.State"
          },
          {
            "name": "model",
            "type": "ModelConfig",
            "modelRef": "researchModel"
          }
        ],
        "function": "console.log('\\n' + '='.repeat(80));\nconsole.log('ğŸ” [ResearchExecution] èª¿æŸ»å®Ÿè¡Œã‚µãƒ¼ãƒèµ·å‹•');\nconsole.log('='.repeat(80));\n\nconst lastMessage = state.messages[state.messages.length - 1];\nlet userContent = '';\n\n// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰ã‚¿ã‚¹ã‚¯èª¬æ˜ã‚’æŠ½å‡º\nif (lastMessage) {\n  if (lastMessage.content) {\n    userContent = lastMessage.content;\n  } else if (lastMessage.parts && Array.isArray(lastMessage.parts)) {\n    userContent = lastMessage.parts[0]?.text || lastMessage.parts[0]?.content || '';\n  } else if (typeof lastMessage === 'string') {\n    userContent = lastMessage;\n  }\n}\n\nconsole.log('\\nğŸ“¨ å—ä¿¡ã—ãŸã‚¿ã‚¹ã‚¯èª¬æ˜:');\nconsole.log('  Content (first 300 chars):', userContent.substring(0, 300));\nconsole.log('  Total length:', userContent.length, 'chars');\n\nif (!userContent || userContent.length === 0) {\n  console.error('âŒ ã‚¿ã‚¹ã‚¯èª¬æ˜ãŒç©ºã§ã™');\n  return {\n    messages: [\n      {\n        role: 'assistant',\n        content: JSON.stringify({\n          result: {\n            researchResults: [],\n            summary: 'ã‚¨ãƒ©ãƒ¼: ã‚¿ã‚¹ã‚¯èª¬æ˜ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“'\n          }\n        })\n      }\n    ]\n  };\n}\n\n// LLMã«æ¤œç´¢å®Ÿè¡Œã‚’ä¾é ¼ï¼ˆMCPãƒ„ãƒ¼ãƒ«ã‚’ä½¿ç”¨ï¼‰\nconsole.log('\\nğŸ” Webæ¤œç´¢ã‚’é–‹å§‹ã—ã¾ã™');\n\nconst researchPrompt = `ä»¥ä¸‹ã®ã‚¿ã‚¹ã‚¯ã«ã¤ã„ã¦ã€Webæ¤œç´¢ãƒ„ãƒ¼ãƒ«ï¼ˆmcp_web-search_searchï¼‰ã‚’ä½¿ç”¨ã—ã¦è©³ç´°ã«èª¿æŸ»ã—ã¦ãã ã•ã„:\n\n${userContent}\n\næŒ‡ç¤º:\n1. æ—¥æœ¬èªã§ã®æ¤œç´¢ã‚’å„ªå…ˆã—ã¦ãã ã•ã„ï¼ˆä¾‹: ã€ŒçŸ¢å´ç·æ¥­ ä¼šç¤¾æ¦‚è¦ã€ã€ŒçŸ¢å´ç·æ¥­ è£½å“ã€ãªã©ï¼‰\n2. è¤‡æ•°ã®ä¿¡é ¼ã§ãã‚‹æƒ…å ±æºã‹ã‚‰æƒ…å ±ã‚’åé›†ã—ã¦ãã ã•ã„ï¼ˆæœ€ä½3å›ã®æ¤œç´¢ã‚’å®Ÿè¡Œï¼‰\n3. å…·ä½“çš„ãªæ•°å€¤ã€æ—¥ä»˜ã€ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚ã¦ãã ã•ã„\n4. æ¤œç´¢çµæœã®URLã‚’å¿…ãšè¨˜éŒ²ã—ã¦ãã ã•ã„\n5. èª¿æŸ»çµæœã¯300æ–‡å­—ä»¥ä¸Šã®è©³ç´°ãªè¦ç´„ã«ã—ã¦ãã ã•ã„\n\nä»¥ä¸‹ã®å½¢å¼ã§çµæœã‚’è¿”ã—ã¦ãã ã•ã„:\nRESEARCH_START\n{\n  \"taskId\": 1,\n  \"objective\": \"ã‚¿ã‚¹ã‚¯ã®ç›®çš„\",\n  \"findings\": \"èª¿æŸ»çµæœã®è©³ç´°ãªè¦ç´„ï¼ˆ300æ–‡å­—ä»¥ä¸Šã€å…·ä½“çš„ãªæ•°å€¤ã‚„ãƒ‡ãƒ¼ã‚¿ã‚’å«ã‚€ï¼‰\",\n  \"sources\": [\"å®Ÿéš›ã«å‚ç…§ã—ãŸURL1\", \"URL2\", \"URL3\"],\n  \"completionStatus\": \"completed\"\n}\nRESEARCH_END`;\n\nlet researchResult;\n\ntry {\n  const response = await model.invoke([\n    { role: 'user', content: researchPrompt }\n  ]);\n\n  const content = response.content || '';\n  console.log('\\nğŸ¤– LLMãƒ¬ã‚¹ãƒãƒ³ã‚¹å—ä¿¡ (first 500 chars):');\n  console.log('  ' + content.substring(0, 500).split('\\n').join('\\n  '));\n  if (content.length > 500) {\n    console.log('  ... (truncated, total length: ' + content.length + ' chars)');\n  }\n\n  // RESEARCH_START/ENDãƒãƒ¼ã‚«ãƒ¼ã§çµæœã‚’æŠ½å‡º\n  const resultMatch = content.match(/RESEARCH_START\\s*([\\s\\S]*?)\\s*RESEARCH_END/);\n\n  if (resultMatch) {\n    researchResult = JSON.parse(resultMatch[1].trim());\n    console.log('âœ… èª¿æŸ»çµæœè§£ææˆåŠŸ');\n    console.log('  Objective:', researchResult.objective);\n    console.log('  Findings length:', researchResult.findings?.length || 0, 'chars');\n    console.log('  Sources count:', researchResult.sources?.length || 0);\n    if (researchResult.sources && researchResult.sources.length > 0) {\n      console.log('  Sources:');\n      researchResult.sources.forEach((src, idx) => {\n        console.log('    [' + (idx + 1) + '] ' + src);\n      });\n    }\n  } else {\n    console.warn('âš ï¸  RESEARCH ãƒãƒ¼ã‚«ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ä½¿ç”¨');\n    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: ãƒãƒ¼ã‚«ãƒ¼ãªã—ã®çµæœ\n    researchResult = {\n      taskId: 1,\n      objective: userContent.substring(0, 100) + '...',\n      findings: content.substring(0, 500),\n      sources: [],\n      completionStatus: 'completed'\n    };\n  }\n} catch (error) {\n  console.error('âŒ èª¿æŸ»å®Ÿè¡Œã‚¨ãƒ©ãƒ¼:', error.message);\n  console.error('  Stack:', error.stack);\n  researchResult = {\n    taskId: 1,\n    objective: userContent.substring(0, 100) + '...',\n    findings: `èª¿æŸ»ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`,\n    sources: [],\n    completionStatus: 'error'\n  };\n}\n\n// çµæœã®æ§‹ç¯‰ï¼ˆãƒ¢ãƒƒã‚¯ã¨åŒã˜ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆï¼‰\nconst result = {\n  result: {\n    researchResults: [researchResult],\n    summary: researchResult.completionStatus === 'completed' ? 'èª¿æŸ»ãŒå®Œäº†ã—ã¾ã—ãŸ' : 'èª¿æŸ»ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ'\n  }\n};\n\nconsole.log('\\nğŸ“Š èª¿æŸ»å®Œäº†');\nconsole.log('  Status:', researchResult.completionStatus);\nconsole.log('  Findings length:', researchResult.findings?.length || 0, 'chars');\nconsole.log('='.repeat(80) + '\\n');\n\nreturn {\n  messages: [\n    {\n      role: 'assistant',\n      content: JSON.stringify(result, null, 2)\n    }\n  ]\n};"
      }
    }
  ],
  "edges": [
    {
      "from": "__start__",
      "to": "research_executor"
    },
    {
      "from": "research_executor",
      "to": "__end__"
    }
  ],
  "stateGraph": {
    "annotationRef": "AgentState",
    "config": {
      "checkpointer": {
        "type": "MemorySaver"
      }
    }
  }
}