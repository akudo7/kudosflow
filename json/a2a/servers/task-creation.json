{
  "config": {
    "info": {
      "version": "1.0.0",
      "description": "Task creation agent for research planning",
      "copyright": "Copyright 2026",
      "author": "Akira Kudo"
    },
    "recursionLimit": 100,
    "eventEmitter": {
      "defaultMaxListeners": 20
    },
    "a2aEndpoint": {
      "port": 3001,
      "agentCard": {
        "name": "TaskCreationAgent",
        "description": "ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆä½œæˆã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ - ãƒ¦ãƒ¼ã‚¶ã®èª¿æŸ»ä¾é ¼ã‹ã‚‰æ§‹é€ åŒ–ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’ç”Ÿæˆã—ã¾ã™",
        "supportedMessageFormats": [
          "text/plain",
          "application/json"
        ],
        "acceptedInputs": [
          {
            "name": "research_request",
            "description": "ãƒ¦ãƒ¼ã‚¶ã‹ã‚‰ã®èª¿æŸ»ä¾é ¼å†…å®¹"
          }
        ],
        "producedOutputs": [
          {
            "name": "task_list",
            "description": "æ§‹é€ åŒ–ã•ã‚ŒãŸã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆ (ç›®çš„ã€æ‰‹æ³•ã€æˆæœç‰©ã‚’å«ã‚€)"
          }
        ]
      }
    }
  },
  "models": [
    {
      "id": "taskModel",
      "type": "OpenAI",
      "config": {
        "model": "gpt-4o-mini",
        "temperature": 0.7
      },
      "systemPrompt": "ã‚ãªãŸã¯å¸‚å ´èª¿æŸ»ã®ã‚¿ã‚¹ã‚¯ä½œæˆã‚’å°‚é–€ã¨ã™ã‚‹ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã§ã™ã€‚\n\nğŸš¨ã€æœ€é‡è¦ãƒ«ãƒ¼ãƒ« - çµ¶å¯¾ã«å®ˆã‚‹ã“ã¨ã€‘ğŸš¨\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\nãƒ¦ãƒ¼ã‚¶ã®å…¥åŠ›ã«å«ã¾ã‚Œã‚‹ä¼æ¥­åãƒ»çµ„ç¹”åã‚’ä¸€å­—ä¸€å¥ãã®ã¾ã¾ä½¿ç”¨ã—ã¦ãã ã•ã„ã€‚\nçµ¶å¯¾ã«åˆ¥ã®ä¼æ¥­åã«å¤‰æ›´ã—ãŸã‚Šã€æ¨æ¸¬ã—ãŸã‚Šã€ç½®ãæ›ãˆãŸã‚Šã—ãªã„ã§ãã ã•ã„ã€‚\nâ”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n\nã€å…·ä½“ä¾‹ã€‘\nâœ… æ­£ã—ã„:\n  å…¥åŠ›: ã€ŒAç¤¾ã®ä¼šç¤¾æ¦‚è¦ã‚’èª¿æŸ»ã€\n  ã‚¿ã‚¹ã‚¯: ã€ŒAç¤¾ã®ä¼šç¤¾æ¦‚è¦ã‚’èª¿æŸ»ã™ã‚‹ã€\n  \nâœ… æ­£ã—ã„:\n  å…¥åŠ›: ã€ŒBç¤¾ã®è£½å“ã‚’èª¿æŸ»ã€  \n  ã‚¿ã‚¹ã‚¯: ã€ŒBç¤¾ã®è£½å“ã‚’èª¿æŸ»ã™ã‚‹ã€\n\nâŒ é–“é•ã„:\n  å…¥åŠ›: ã€ŒAç¤¾ã®ä¼šç¤¾æ¦‚è¦ã‚’èª¿æŸ»ã€\n  ã‚¿ã‚¹ã‚¯: ã€ŒBç¤¾ã®ä¼šç¤¾æ¦‚è¦ã‚’èª¿æŸ»ã™ã‚‹ã€â† çµ¶å¯¾NG!!!\n  ï¼ˆãƒ¦ãƒ¼ã‚¶ãŒæŒ‡å®šã—ãŸä¼æ¥­åã‚’åˆ¥ã®ä¼æ¥­åã«ç½®ãæ›ãˆã¦ã¯ã„ã‘ã¾ã›ã‚“ï¼‰\n\nè²¬ä»»:\n1. ãƒ¦ãƒ¼ã‚¶ã®èª¿æŸ»ä¾é ¼ã‚’åˆ†æã—ã€å®Ÿè¡Œå¯èƒ½ãªã‚¿ã‚¹ã‚¯ã«åˆ†è§£ã™ã‚‹\n2. å„ã‚¿ã‚¹ã‚¯ã«æ˜ç¢ºãªç›®çš„ã€æ‰‹æ³•ã€æˆæœç‰©ã€æˆåŠŸåŸºæº–ã‚’è¨­å®šã™ã‚‹\n3. ã‚¿ã‚¹ã‚¯ã®å„ªå…ˆé †ä½ä»˜ã‘ã¨ä¾å­˜é–¢ä¿‚ã®ç‰¹å®š\n4. ã‚¿ã‚¹ã‚¯ã®å®Ÿç¾å¯èƒ½æ€§ã¨ã‚¹ã‚³ãƒ¼ãƒ—ã®æ¤œè¨¼\n\nã‚¿ã‚¹ã‚¯ä½œæˆã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³:\n- å„ã‚¿ã‚¹ã‚¯ã«ã¯ä»¥ä¸‹ã‚’å«ã‚ã‚‹: æ˜ç¢ºãªç›®çš„ã€å…·ä½“çš„ãªæ‰‹æ³•ã€æœŸå¾…ã•ã‚Œã‚‹æˆæœç‰©ã€æˆåŠŸåŸºæº–ã€è¦‹ç©å·¥æ•°\n- ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹ã€èª¿æŸ»æ–¹æ³•ã€åˆ†æã‚¢ãƒ—ãƒ­ãƒ¼ãƒã‚’è€ƒæ…®ã™ã‚‹\n- å¯èƒ½ãªé™ã‚Šã‚¿ã‚¹ã‚¯ã‚’ç‹¬ç«‹ã•ã›ã‚‹\n- æ¤œè¨¼ã¨å“è³ªãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆã‚’å«ã‚ã‚‹\n- æ½œåœ¨çš„ãªèª²é¡Œã¨ä»£æ›¿æ¡ˆã‚’è€ƒæ…®ã™ã‚‹\n\næ—¥æœ¬èªã§ã®èª¿æŸ»ä¾é ¼ã«å¯¾å¿œã—ã€åŒ…æ‹¬çš„ã§å®Ÿè¡Œå¯èƒ½ãªã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚"
    }
  ],
  "stateAnnotation": {
    "name": "AgentState",
    "type": "Annotation.Root"
  },
  "annotation": {
    "messages": {
      "type": "BaseMessage[]",
      "reducer": "(x, y) => x.concat(y)",
      "default": []
    },
    "taskList": {
      "type": "any[]",
      "reducer": "(x, y) => y",
      "default": []
    }
  },
  "nodes": [
    {
      "id": "task_creator",
      "handler": {
        "parameters": [
          {
            "name": "state",
            "parameterType": "state",
            "stateType": "typeof AgentState.State"
          },
          {
            "name": "model",
            "parameterType": "model",
            "modelRef": "taskModel"
          }
        ],
        "function": "const lastMessage = state.messages[state.messages.length - 1];\nlet userContent = '';\n\n// ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‹ã‚‰ãƒ¦ãƒ¼ã‚¶å…¥åŠ›ã‚’æŠ½å‡º\nif (lastMessage) {\n  if (lastMessage.content) {\n    userContent = lastMessage.content;\n  } else if (lastMessage.parts && Array.isArray(lastMessage.parts)) {\n    userContent = lastMessage.parts[0]?.text || lastMessage.parts[0]?.content || '';\n  } else if (typeof lastMessage === 'string') {\n    userContent = lastMessage;\n  }\n}\n\nconsole.log('ğŸ“ ã‚¿ã‚¹ã‚¯ä½œæˆãƒªã‚¯ã‚¨ã‚¹ãƒˆ:', userContent);\n\n// ä¼æ¥­åã‚’æŠ½å‡º\nconst companyNameMatch = userContent.match(/([^\\\\s]+)ã®ä¼šç¤¾æ¦‚è¦|([^\\\\s]+)ã®è£½å“|([^\\\\s]+)ã®å¼·ã¿|([^\\\\s]+)ã‚’èª¿æŸ»/);\nconst companyName = companyNameMatch ? (companyNameMatch[1] || companyNameMatch[2] || companyNameMatch[3] || companyNameMatch[4]) : null;\n\nif (companyName) {\n  console.log('ğŸ¢ æ¤œå‡ºã•ã‚ŒãŸä¼æ¥­å:', companyName);\n}\n\n// LLMãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã®ä½œæˆ\nconst taskPrompt = `ä»¥ä¸‹ã®èª¿æŸ»ä¾é ¼ã«å¯¾ã—ã¦ã€è©³ç´°ãªã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’ä½œæˆã—ã¦ãã ã•ã„:\n\n${userContent}\n\nğŸš¨ ã€çµ¶å¯¾ã«å®ˆã‚‹ã“ã¨ã€‘ğŸš¨\n${companyName ? `- ã“ã®èª¿æŸ»ã®å¯¾è±¡ä¼æ¥­ã¯ã€Œ${companyName}ã€ã§ã™\\n- å…¨ã¦ã®ã‚¿ã‚¹ã‚¯ã§ã€Œ${companyName}ã€ã¨ã„ã†åå‰ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„\\n- ã€Œ${companyName}ã€ã‚’åˆ¥ã®ä¼æ¥­åã«å¤‰æ›´ã™ã‚‹ã“ã¨ã¯çµ¶å¯¾ã«ç¦æ­¢ã§ã™` : '- ãƒ¦ãƒ¼ã‚¶ãŒæŒ‡å®šã—ãŸä¼æ¥­åãƒ»çµ„ç¹”åã‚’ãã®ã¾ã¾ä½¿ç”¨ã—ã¦ãã ã•ã„'}\n- ä¼æ¥­åã‚’æ¨æ¸¬ã—ãŸã‚Šã€åˆ¥ã®åå‰ã«ç½®ãæ›ãˆãŸã‚Šã—ãªã„ã§ãã ã•ã„\n\nå„ã‚¿ã‚¹ã‚¯ã¯ä»¥ä¸‹ã®JSONå½¢å¼ã§ä½œæˆã—ã¦ãã ã•ã„:\n{\n  \"id\": ã‚¿ã‚¹ã‚¯ID (æ•°å€¤),\n  \"objective\": \"ã‚¿ã‚¹ã‚¯ã®ç›®çš„\",\n  \"methodology\": \"èª¿æŸ»æ‰‹æ³•\",\n  \"deliverables\": \"æˆæœç‰©\",\n  \"success_criteria\": \"æˆåŠŸåŸºæº–\",\n  \"estimated_effort\": \"è¦‹ç©å·¥æ•°ï¼ˆä¾‹: 2æ™‚é–“ï¼‰\",\n  \"dependencies\": \"ä¾å­˜ã‚¿ã‚¹ã‚¯ï¼ˆä¾‹: ã‚¿ã‚¹ã‚¯1, 2ï¼‰\"\n}\n\nå¿…ãšä»¥ä¸‹ã®å½¢å¼ã§ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’è¿”ã—ã¦ãã ã•ã„:\nTASK_LIST_START\n[JSONã‚¿ã‚¹ã‚¯é…åˆ—]\nTASK_LIST_END\n\nã¾ãŸã€ç·ã‚¿ã‚¹ã‚¯æ•°ã¨ç·è¦‹ç©æ™‚é–“ã‚‚è¨ˆç®—ã—ã¦ãã ã•ã„ã€‚`;\n\n// LLMå‘¼ã³å‡ºã—\nconst response = await model.invoke([\n  { role: 'user', content: taskPrompt }\n]);\n\nconst content = response.content || '';\nconsole.log('ğŸ¤– LLMãƒ¬ã‚¹ãƒãƒ³ã‚¹å—ä¿¡:', content.substring(0, 200));\n\n// ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã®æŠ½å‡º\nconst taskListMatch = content.match(/TASK_LIST_START\\s*([\\s\\S]*?)\\s*TASK_LIST_END/);\nlet taskList = [];\n\nif (taskListMatch) {\n  try {\n    taskList = JSON.parse(taskListMatch[1].trim());\n    console.log('âœ… ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆè§£ææˆåŠŸ:', taskList.length, 'ã‚¿ã‚¹ã‚¯');\n  } catch (e) {\n    console.error('âŒ ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆè§£æã‚¨ãƒ©ãƒ¼:', e);\n    // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚¿ã‚¹ã‚¯\n    taskList = [\n      {\n        id: 1,\n        objective: userContent,\n        methodology: 'æƒ…å ±åé›†ã¨åˆ†æ',\n        deliverables: 'èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ',\n        success_criteria: 'åŒ…æ‹¬çš„ãªæƒ…å ±åé›†',\n        estimated_effort: '3æ™‚é–“',\n        dependencies: 'ãªã—'\n      }\n    ];\n  }\n} else {\n  console.warn('âš ï¸  TASK_LIST ãƒãƒ¼ã‚«ãƒ¼ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ä½¿ç”¨');\n  taskList = [\n    {\n      id: 1,\n      objective: userContent,\n      methodology: 'æƒ…å ±åé›†ã¨åˆ†æ',\n      deliverables: 'èª¿æŸ»ãƒ¬ãƒãƒ¼ãƒˆ',\n      success_criteria: 'åŒ…æ‹¬çš„ãªæƒ…å ±åé›†',\n      estimated_effort: '3æ™‚é–“',\n      dependencies: 'ãªã—'\n    }\n  ];\n}\n\n// ç·æ™‚é–“ã®è¨ˆç®—\nconst totalHours = taskList.reduce((sum, task) => {\n  const hours = parseInt((task.estimated_effort || '0æ™‚é–“').replace(/[^\\d]/g, '')) || 0;\n  return sum + hours;\n}, 0);\n\n// ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®æ§‹ç¯‰\nconst result = {\n  result: {\n    taskList: taskList,\n    totalTasks: taskList.length,\n    totalEstimatedHours: totalHours\n  }\n};\n\nconsole.log('ğŸ“Š ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆå®Œæˆ:', result.result.totalTasks, 'ã‚¿ã‚¹ã‚¯,', result.result.totalEstimatedHours, 'æ™‚é–“');\n\nreturn {\n  messages: [\n    {\n      role: 'assistant',\n      content: JSON.stringify(result, null, 2)\n    }\n  ],\n  taskList: taskList\n};"
      }
    }
  ],
  "edges": [
    {
      "from": "__start__",
      "to": "task_creator"
    },
    {
      "from": "task_creator",
      "to": "__end__"
    }
  ],
  "stateGraph": {
    "annotationRef": "AgentState",
    "config": {
      "checkpointer": {
        "type": "MemorySaver"
      }
    }
  }
}