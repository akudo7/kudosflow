{
  "config": {
    "recursionLimit": 25,
    "eventEmitter": {
      "defaultMaxListeners": 10
    }
  },
  "stateAnnotation": {
    "name": "TestWorkflowState",
    "type": "Annotation.Root"
  },
  "annotation": {
    "messages": {
      "type": "string[]",
      "reducer": "(x, y) => x.concat(y)",
      "default": []
    },
    "userName": {
      "type": "string",
      "reducer": "(x, y) => y || x",
      "default": ""
    },
    "userJob": {
      "type": "string",
      "reducer": "(x, y) => y || x",
      "default": ""
    },
    "advice": {
      "type": "string",
      "reducer": "(x, y) => y || x",
      "default": ""
    }
  },
  "models": [
    {
      "id": "adviceModel",
      "type": "OpenAI",
      "config": {
        "model": "gpt-4o-mini",
        "temperature": 0.7
      },
      "systemPrompt": "ã‚ãªãŸã¯è·æ¥­ã‚«ã‚¦ãƒ³ã‚»ãƒ©ãƒ¼ã§ã™ã€‚ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®è·æ¥­ã«åŸºã¥ã„ã¦ã€é©åˆ‡ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’100æ–‡å­—ä»¥å†…ã§æä¾›ã—ã¦ãã ã•ã„ã€‚ç°¡æ½”ã§å®Ÿè·µçš„ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’å¿ƒãŒã‘ã¦ãã ã•ã„ã€‚"
    }
  ],
  "nodes": [
    {
      "id": "askName",
      "function": {
        "parameters": [
          {
            "name": "state",
            "type": "typeof TestWorkflowState.State"
          }
        ],
        "output": {
          "messages": "string[]",
          "userName": "string"
        },
        "implementation": "const userInput = interrupt('ã‚ãªãŸã®åå‰ã¯ï¼Ÿ');\n\nif (!userInput) {\n  return {\n    messages: ['åå‰ãŒå…¥åŠ›ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ'],\n    userName: ''\n  };\n}\n\nconst userName = String(userInput).trim();\nconst result = {\n  messages: [`ã“ã‚“ã«ã¡ã¯ ${userName} ã•ã‚“ï¼`],\n  userName: userName\n};\n\nreturn result;"
      }
    },
    {
      "id": "askJob",
      "function": {
        "parameters": [
          {
            "name": "state",
            "type": "typeof TestWorkflowState.State"
          }
        ],
        "output": {
          "messages": "string[]",
          "userJob": "string"
        },
        "implementation": "const userInput = interrupt('ã‚ãªãŸã®è·æ¥­ã¯ï¼Ÿ');\n\nif (!userInput) {\n  return {\n    messages: ['è·æ¥­ãŒå…¥åŠ›ã•ã‚Œã¾ã›ã‚“ã§ã—ãŸ'],\n    userJob: ''\n  };\n}\n\nconst userJob = String(userInput).trim();\nconst result = {\n  messages: [`è·æ¥­: ${userJob}ã‚’æ‰¿ã‚Šã¾ã—ãŸã€‚ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ç”Ÿæˆä¸­...`],\n  userJob: userJob\n};\n\nreturn result;"
      }
    },
    {
      "id": "generateAdvice",
      "function": {
        "parameters": [
          {
            "name": "state",
            "type": "typeof TestWorkflowState.State"
          },
          {
            "name": "model",
            "type": "ModelConfig",
            "modelRef": "adviceModel"
          }
        ],
        "output": {
          "messages": "string[]",
          "advice": "string"
        },
        "implementation": "try {\n  console.log('ğŸ” è·æ¥­ã«åŸºã¥ãã‚¢ãƒ‰ãƒã‚¤ã‚¹ç”Ÿæˆä¸­...');\n  console.log('ğŸ‘¤ åå‰:', state.userName);\n  console.log('ğŸ’¼ è·æ¥­:', state.userJob);\n\n  if (!state.userJob || state.userJob === '') {\n    return {\n      messages: ['è·æ¥­ãŒè¨­å®šã•ã‚Œã¦ã„ãªã„ãŸã‚ã€ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ç”Ÿæˆã§ãã¾ã›ã‚“'],\n      advice: ''\n    };\n  }\n\n  const prompt = `${state.userJob}ã¨ã—ã¦åƒã${state.userName}ã•ã‚“ã«å¯¾ã—ã¦ã€ã‚­ãƒ£ãƒªã‚¢ã‚¢ãƒƒãƒ—ã‚„ä»•äº‹ã®è³ªã‚’å‘ä¸Šã•ã›ã‚‹ãŸã‚ã®å®Ÿè·µçš„ãªã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’100æ–‡å­—ä»¥å†…ã§æä¾›ã—ã¦ãã ã•ã„ã€‚`;\n\n  const response = await model.invoke([{ role: 'user', content: prompt }]);\n\n  const adviceText = response.content || 'ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã®ç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸ';\n  \n  console.log('ğŸ“‹ ç”Ÿæˆã•ã‚ŒãŸã‚¢ãƒ‰ãƒã‚¤ã‚¹:', adviceText);\n\n  return {\n    messages: [`ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã‚’ç”Ÿæˆã—ã¾ã—ãŸ`],\n    advice: adviceText\n  };\n} catch (error) {\n  console.error('âŒ ã‚¨ãƒ©ãƒ¼:', error);\n  return {\n    messages: [`ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ${error.message}`],\n    advice: ''\n  };\n}"
      }
    },
    {
      "id": "showResult",
      "function": {
        "parameters": [
          {
            "name": "state",
            "type": "typeof TestWorkflowState.State"
          }
        ],
        "output": {
          "messages": "string[]"
        },
        "implementation": "const adviceMessage = `ã€${state.userName}ã•ã‚“ï¼ˆ${state.userJob}ï¼‰ã¸ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã€‘\\n\\n${state.advice}`;\n\ninterrupt(adviceMessage);\n\nconsole.log('ğŸ” æœ€çµ‚çµæœ:', adviceMessage);\n\nreturn {\n  messages: [adviceMessage, 'å‡¦ç†ãŒå®Œäº†ã—ã¾ã—ãŸ']\n};"
      }
    }
  ],
  "edges": [
    {
      "from": "__start__",
      "to": "askName"
    },
    {
      "from": "askName",
      "to": "askJob"
    },
    {
      "from": "askJob",
      "to": "generateAdvice"
    },
    {
      "from": "generateAdvice",
      "to": "showResult"
    },
    {
      "from": "showResult",
      "to": "__end__"
    }
  ],
  "stateGraph": {
    "annotationRef": "TestWorkflowState",
    "config": {
      "checkpointer": {
        "type": "MemorySaver"
      }
    }
  }
}
